!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ExcellentExport=t():e.ExcellentExport=t()}(self,(()=>(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{default:()=>c});const n=function(e,t,n){t=t||"",n=n||512;const o=atob(e),r=[];for(let e=0;e<o.length;e+=n){const t=o.slice(e,e+n),i=new Array(t.length);for(let e=0;e<t.length;e+=1)i[e]=t.charCodeAt(e);const c=new Uint8Array(i);r.push(c)}return new Blob(r,{type:t})},o=function(e,t){let n=e;const o=-1!==e.indexOf(t)||-1!==e.indexOf("\r")||-1!==e.indexOf("\n"),r=-1!==e.indexOf('"');return r&&(n=n.replace(/"/g,'""')),(o||r)&&(n='"'+n+'"'),n},r=function(e){return Array.prototype.map.call(e.querySelectorAll("tr"),(function(e){return Array.prototype.map.call(e.querySelectorAll("th,td"),(function(e){return e.innerHTML}))}))},i=function(e,t,o,r){if(window.navigator.msSaveBlob){const e=n(t,o);return window.navigator.msSaveBlob(e,r),!1}if(window.URL.createObjectURL){const r=n(t,o);e.href=window.URL.createObjectURL(r)}else e.download=r,e.href="data:"+o+";base64,"+t;return!0},c={version:function(){return"4.0.0"},convert:function(e,t){return function(e,t){let n,c=",",f="\r\n";if(void 0!==t.delimiter&&t.delimiter&&(c=t.delimiter),void 0!==t.newLine&&t.newLine&&(f=t.newLine),t.from&&t.from.table)n=r("string"==typeof(a=t.from.table)?document.getElementById(a):a);else{if(!t.from||!t.from.array)throw new Error("No data for sheet: ["+name+"]");n=t.from.array}var a;if(t.filterRowFn){if(!(t.filterRowFn instanceof Function))throw new Error('Parameter "filterRowFn" must be a function.');n=n.filter(t.filterRowFn)}if(t.removeColumns&&function(e,t){[...new Set(t)].sort().reverse().forEach((function(t){e.forEach((function(e){e.splice(t,1)}))}))}(n,t.removeColumns),t.fixValue&&"function"==typeof t.fixValue){const e=t.fixValue;n.map(((t,o)=>{t.map(((t,r)=>{n[o][r]=e(t,o,r)}))}))}if(t.fixArray&&"function"==typeof t.fixArray){const e=t.fixArray;n=e(n)}const l="\ufeff"+function(e,t=",",n="\n"){let r="";for(let i=0;i<e.length;i+=1){const c=e[i];for(let e=0;e<c.length;e+=1){const n=c[e];r=r+(e?t:"")+o(String(n),t)}r+=n}return r}(n,c,f),u=btoa(unescape(encodeURIComponent(l)));try{const t=(e.filename||"download")+".csv";if(e.anchor){const n=function(e){return"string"==typeof e?document.getElementById(e):e}(e.anchor);return i(n,u,"application/csv",t)}if(!e.openAsDownload)throw new Error("Options should specify an anchor or openAsDownload=true.");{const e=document.createElement("a");i(e,u,"application/csv",t)&&(document.body.appendChild(e),e.click(),document.body.removeChild(e))}}catch(e){throw new Error("Error converting to CSV. "+e)}return l}(e,t)},tableToArray:r};return t.default})()));